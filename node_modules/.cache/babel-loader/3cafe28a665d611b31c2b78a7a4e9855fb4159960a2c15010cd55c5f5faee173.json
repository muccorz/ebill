{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport flatpickr from 'flatpickr';\nimport 'flatpickr/dist/flatpickr.css';\nimport 'flatpickr/dist/l10n/ja';\nexport default {\n  name: \"editView\",\n  data() {\n    return {\n      createBtText: '作 成',\n      rewriteFlag: false,\n      remarkFlag: true,\n      createBt: true,\n      billTypes: [],\n      customers: [],\n      //帳票詳細\n      bill: {\n        billno: '',\n        updateuserId: '',\n        billTypeno: '',\n        customerno: '',\n        remark: '',\n        transactionAmount: '',\n        transactionymd: '',\n        imageUrl: ''\n      }\n    };\n  },\n  computed: {\n    setCreateBt() {\n      if (this.bill.billno != undefined) {\n        return this.bill.billTypeno == '' || this.bill.customerno == '' || this.bill.transactionAmount == '' || this.bill.transactionymd == '' || this.bill.imageUrl == '' || this.bill.remark == '';\n      } else {\n        return this.bill.billTypeno == '' || this.bill.customerno == '' || this.bill.transactionAmount == '' || this.bill.transactionymd == '' || this.bill.imageUrl == '';\n      }\n    }\n  },\n  methods: {\n    create() {\n      this.bill.updateuserId = sessionStorage.getItem('userId');\n      if (this.bill.billno != undefined) {\n        this.$http.post('/bill/editBill', this.bill).then(res => {\n          if (res.data.code == 200) {\n            this.$message({\n              type: 'success',\n              message: '訂正成功'\n            });\n            this.$router.push('/search');\n          }\n        });\n      } else {\n        this.$http.post('/bill/createBill', this.bill).then(res => {\n          if (res.data.code == 200) {\n            this.$message({\n              type: 'success',\n              message: '作成成功'\n            });\n            this.$router.push('/search');\n          }\n        });\n      }\n    },\n    cancel() {\n      this.$router.push('/search');\n    },\n    handleAvatarSuccess(response) {\n      console.log(response);\n      this.bill.imageUrl = \"https://solution.fielding.co.jp/application/files/6516/3910/2834/column-3.png\";\n    },\n    //金額のチェック\n    checkAmountFrom() {\n      if (!/^-?\\d+$/.test(this.bill.transactionAmount) && this.bill.transactionAmount != '') {\n        this.$message({\n          type: 'error',\n          message: '数字のみ入力'\n        });\n        this.bill.transactionAmount = '';\n      }\n    },\n    //サーバーからデータを取得する\n    loadCustomers() {\n      this.$http.get('/category/getCustomers').then(res => {\n        if (res.date.code == 200) {\n          return res.data.data;\n        }\n      });\n      return [{\n        \"customer\": \"三全鲜食（北新泾店）\",\n        \"customerno\": 1\n      }, {\n        \"customer\": \"Hot honey 首尔炸鸡（仙霞路）\",\n        \"customerno\": 2\n      }];\n    },\n    loadBillTypes() {\n      this.$http.get('/category/getBillStyles').then(res => {\n        if (res.date.code == 200) {\n          return res.data.data;\n        }\n      });\n      return [{\n        \"billType\": \"胖仙女纸杯蛋糕（上海凌空店）\",\n        \"billTypeno\": 1\n      }, {\n        \"billType\": \"贡茶\",\n        \"billTypeno\": 2\n      }];\n    },\n    init() {\n      this.bill.billno = this.$route.params.billno;\n      if (this.bill.billno != undefined) {\n        //     this.$http.get('/bill/getBillDetails/' + billno)\n        // .then(res => {\n        //       this.bill = res.data;\n        //     })\n        //   }\n        this.bill.billTypeno = 1;\n        this.bill.customerno = 2;\n        this.bill.remark = '当帳票の詳細を表示する';\n        this.bill.transactionAmount = '￥99999.00';\n        this.bill.transactionymd = '2023/11/24';\n        this.bill.updateuserId = 'admin';\n        this.bill.updateymd = '2023/11/24';\n        this.bill.imageUrl = \"https://solution.fielding.co.jp/application/files/6516/3910/2834/column-3.png\";\n        this.rewriteFlag = true;\n        this.remarkFlag = false;\n        this.createBtText = '訂 正';\n      } else {\n        this.bill.billTypeno = '';\n        this.bill.customerno = '';\n        this.bill.remark = '';\n        this.bill.transactionAmount = '';\n        this.bill.transactionymd = '';\n        this.bill.updateuserId = '';\n        this.bill.updateymd = '';\n        this.bill.imageUrl = '';\n        this.rewriteFlag = false;\n        this.remarkFlag = true;\n        this.createBtText = '作 成';\n      }\n    }\n  },\n  watch: {\n    $route() {\n      this.init();\n      console.log(\"sadaksdjalks\");\n    }\n  },\n  mounted() {\n    flatpickr(this.$refs.datepickerInput, {\n      dateFormat: 'Y/m/d',\n      locale: 'ja',\n      firstDayOfWeek: '0',\n      allowInput: 'true',\n      minDate: \"1990/01/01\",\n      maxDate: \"today\"\n    });\n    this.customers = this.loadCustomers();\n    this.billTypes = this.loadBillTypes();\n  },\n  created() {\n    this.init();\n  }\n};","map":{"version":3,"names":["flatpickr","name","data","createBtText","rewriteFlag","remarkFlag","createBt","billTypes","customers","bill","billno","updateuserId","billTypeno","customerno","remark","transactionAmount","transactionymd","imageUrl","computed","setCreateBt","undefined","methods","create","sessionStorage","getItem","$http","post","then","res","code","$message","type","message","$router","push","cancel","handleAvatarSuccess","response","console","log","checkAmountFrom","test","loadCustomers","get","date","loadBillTypes","init","$route","params","updateymd","watch","mounted","$refs","datepickerInput","dateFormat","locale","firstDayOfWeek","allowInput","minDate","maxDate","created"],"sources":["src/views/edit.vue"],"sourcesContent":["<template lang=\"\">\r\n    <div>\r\n        <div style=\"margin: 30px 100px; \" class=\"d-flex\">\r\n            <div style=\"width: 44%;\">\r\n                <el-form ref=\"form\" :model=\"bill\" label-width=\"120px\">\r\n                    <el-form-item label=\"帳票No\" v-if=\"rewriteFlag\">\r\n                        <span style=\"font-size: 16px;\">{{bill.billno}}</span>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"取引年月日\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                        <input type=\"text\" ref=\"datepickerInput\" v-model=\"bill.transactionymd\" class=\"el-input__inner\"\r\n                            style=\"width: 85%; \" placeholder=\"入力或いは選択してください\">\r\n                    </el-form-item>\r\n                    <el-form-item label=\"取引金額\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                        <el-input v-model=\"bill.transactionAmount\" style=\"width: 85%;\" @blur=\"checkAmountFrom\"\r\n                            placeholder=\"￥\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"取引先\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                        <el-select v-model=\"bill.customerno\" filterable placeholder=\"入力又は選択\" style=\"width: 85%;\">\r\n                            <el-option v-for=\"customer in customers\" :key=\"customer.customerno\"\r\n                                :label=\"customer.customer\" :value=\"customer.customerno\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"帳票種類\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                        <el-select v-model=\"bill.billTypeno\" filterable placeholder=\"入力又は選択\" style=\"width: 85%;\">\r\n                            <el-option v-for=\"billType in billTypes\" :key=\"billType.billTypeno\"\r\n                                :label=\"billType.billType\" :value=\"billType.billTypeno\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"備考\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                        <el-input type=\"textarea\" :rows=\"3\" v-model=\"bill.remark\" style=\"width: 85%;\"\r\n                            placeholder=\"訂正の時必ず入力してください\"></el-input>\r\n                    </el-form-item>\r\n                </el-form>\r\n                <el-button size=\"medium\" type=\"primary\" @click=\"create\"\r\n                    :disabled=\"setCreateBt\">{{createBtText}}</el-button>\r\n                <el-button size=\"medium\" type=\"warning\" @click=\"cancel\">キャンセル</el-button>\r\n            </div>\r\n            <el-upload class=\"avatar-uploader\" action=\"http://127.0.0.1:8081\" :show-file-list=\"false\"\r\n            :on-error=\"handleAvatarSuccess\">\r\n            <el-button size=\"small\" type=\"primary\">アップロードファイル</el-button>\r\n            <embed v-if=\"bill.imageUrl\" :src=\"bill.imageUrl\" type=\"application/pdf\" width=\"48%\" height=\"83%\"\r\n                style=\"position: absolute; top: 17%; left: 51%;\">\r\n        </el-upload>\r\n\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import flatpickr from 'flatpickr';\r\n    import 'flatpickr/dist/flatpickr.css';\r\n    import 'flatpickr/dist/l10n/ja';\r\n    export default {\r\n        name: \"editView\",\r\n        data() {\r\n            return {\r\n                createBtText: '作 成',\r\n                rewriteFlag: false,\r\n                remarkFlag: true,\r\n                createBt: true,\r\n                billTypes: [],\r\n                customers: [],\r\n                //帳票詳細\r\n                bill: {\r\n                    billno: '',\r\n                    updateuserId: '',\r\n                    billTypeno: '',\r\n                    customerno: '',\r\n                    remark: '',\r\n                    transactionAmount: '',\r\n                    transactionymd: '',\r\n                    imageUrl: '',\r\n                },\r\n            }\r\n        },\r\n        computed: {\r\n            setCreateBt() {\r\n                if (this.bill.billno != undefined) {\r\n                    return this.bill.billTypeno == '' || this.bill.customerno == '' || this.bill.transactionAmount == '' || this.bill.transactionymd == '' || this.bill.imageUrl == '' || this.bill.remark == '';\r\n                } else {\r\n                    return this.bill.billTypeno == '' || this.bill.customerno == '' || this.bill.transactionAmount == '' || this.bill.transactionymd == '' || this.bill.imageUrl == '';\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            create() {\r\n                this.bill.updateuserId = sessionStorage.getItem('userId');\r\n                if (this.bill.billno != undefined) {\r\n                    this.$http.post('/bill/editBill', this.bill)\r\n                        .then(res => {\r\n                            if (res.data.code == 200) {\r\n                                this.$message({\r\n                                    type: 'success',\r\n                                    message: '訂正成功'\r\n                                });\r\n                                this.$router.push('/search');\r\n                            }\r\n                        })\r\n                } else {\r\n                    this.$http.post('/bill/createBill', this.bill)\r\n                        .then(res => {\r\n                            if (res.data.code == 200) {\r\n                                this.$message({\r\n                                    type: 'success',\r\n                                    message: '作成成功'\r\n                                });\r\n                                this.$router.push('/search');\r\n                            }\r\n                        })\r\n                }\r\n            },\r\n            cancel() {\r\n                this.$router.push('/search');\r\n            },\r\n            handleAvatarSuccess(response) {\r\n                console.log(response);\r\n                this.bill.imageUrl = \"https://solution.fielding.co.jp/application/files/6516/3910/2834/column-3.png\";\r\n            },\r\n\r\n            //金額のチェック\r\n            checkAmountFrom() {\r\n                if (!/^-?\\d+$/.test(this.bill.transactionAmount) && this.bill.transactionAmount != '') {\r\n                    this.$message({\r\n                        type: 'error',\r\n                        message: '数字のみ入力'\r\n                    });\r\n                    this.bill.transactionAmount = '';\r\n                }\r\n            },\r\n\r\n            //サーバーからデータを取得する\r\n            loadCustomers() {\r\n                this.$http.get('/category/getCustomers').then(res => {\r\n                    if (res.date.code == 200) {\r\n                        return res.data.data;\r\n                    }\r\n                });\r\n                return [\r\n                    { \"customer\": \"三全鲜食（北新泾店）\", \"customerno\": 1 },\r\n                    { \"customer\": \"Hot honey 首尔炸鸡（仙霞路）\", \"customerno\": 2 }\r\n                ];\r\n\r\n            },\r\n            loadBillTypes() {\r\n                this.$http.get('/category/getBillStyles').then(res => {\r\n                    if (res.date.code == 200) {\r\n                        return res.data.data;\r\n                    }\r\n                });\r\n                return [\r\n                    { \"billType\": \"胖仙女纸杯蛋糕（上海凌空店）\", \"billTypeno\": 1 },\r\n                    { \"billType\": \"贡茶\", \"billTypeno\": 2 },\r\n                ];\r\n            },\r\n\r\n\r\n            init() {\r\n                this.bill.billno = this.$route.params.billno;\r\n                if (this.bill.billno != undefined) {\r\n                    //     this.$http.get('/bill/getBillDetails/' + billno)\r\n                    // .then(res => {\r\n                    //       this.bill = res.data;\r\n                    //     })\r\n                    //   }\r\n                    this.bill.billTypeno = 1;\r\n                    this.bill.customerno = 2;\r\n                    this.bill.remark = '当帳票の詳細を表示する';\r\n                    this.bill.transactionAmount = '￥99999.00';\r\n                    this.bill.transactionymd = '2023/11/24';\r\n                    this.bill.updateuserId = 'admin';\r\n                    this.bill.updateymd = '2023/11/24';\r\n                    this.bill.imageUrl = \"https://solution.fielding.co.jp/application/files/6516/3910/2834/column-3.png\";\r\n                    this.rewriteFlag = true;\r\n                    this.remarkFlag = false;\r\n                    this.createBtText = '訂 正';\r\n                } else {\r\n                    this.bill.billTypeno = '';\r\n                    this.bill.customerno = '';\r\n                    this.bill.remark = '';\r\n                    this.bill.transactionAmount = '';\r\n                    this.bill.transactionymd = '';\r\n                    this.bill.updateuserId = '';\r\n                    this.bill.updateymd = '';\r\n                    this.bill.imageUrl = '';\r\n                    this.rewriteFlag = false;\r\n                    this.remarkFlag = true;\r\n                    this.createBtText = '作 成';\r\n                }\r\n            }\r\n        },\r\n        watch: {\r\n            $route() {\r\n                this.init();\r\n                console.log(\"sadaksdjalks\");\r\n            }\r\n        },\r\n        mounted() {\r\n            flatpickr(this.$refs.datepickerInput, {\r\n                dateFormat: 'Y/m/d',\r\n                locale: 'ja',\r\n                firstDayOfWeek: '0',\r\n                allowInput:'true',\r\n                minDate\t: \"1990/01/01\",\r\n                maxDate : \"today\",\r\n            });\r\n            this.customers = this.loadCustomers();\r\n            this.billTypes = this.loadBillTypes();\r\n        },\r\n        created() {\r\n            this.init();\r\n        }\r\n    }\r\n</script>\r\n<style scoped>\r\n    .el-table :deep() .cell {\r\n        /* overflow: hidden; */\r\n        /* text-overflow: ellipsis; */\r\n        white-space: nowrap;\r\n\r\n    }\r\n\r\n    .block {\r\n        position: absolute;\r\n        bottom: 40px;\r\n        left: 47%;\r\n    }\r\n\r\n    .avatar-uploader .el-upload {\r\n        border: 1px dashed #d9d9d9;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        position: relative;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .avatar-uploader .el-upload:hover {\r\n        border-color: #409EFF;\r\n    }\r\n\r\n    .avatar-uploader-icon {\r\n        font-size: 28px;\r\n        color: #8c939d;\r\n        width: 178px;\r\n        height: 178px;\r\n        line-height: 178px;\r\n        text-align: center;\r\n    }\r\n\r\n    .avatar {\r\n        width: 178px;\r\n        height: 178px;\r\n        display: block;\r\n    }\r\n\r\n    .el-button {\r\n        margin: 5px;\r\n    }\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}